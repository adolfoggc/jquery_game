<!DOCTYPE html>
<html>
<head>
	<title>Mapa</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<meta charset="utf-8">
</head>
<body>
	<div class="grid">
		<div class="row">
			<div id="id_0_0" class="cell"></div><div id="id_1_0" class="cell"></div><div id="id_2_0" class="cell"></div><div id="id_3_0" class="cell"></div><div id="id_4_0" class="cell"></div>
		</div>
		<div class="row">
			<div id="id_0_1" class="cell"></div><div id="id_1_1" class="cell"></div><div id="id_2_1" class="cell"></div><div id="id_3_1" class="cell"></div><div id="id_4_1" class="cell"></div>
		</div>
		<div class="row">
			<div id="id_0_2" class="cell"></div><div id="id_1_2" class="cell"></div><div id="id_2_2" class="cell"></div><div id="id_3_2" class="cell"></div><div id="id_4_2" class="cell"></div>
		</div>
		<div class="row">
			<div id="id_0_3" class="cell"></div><div id="id_1_3" class="cell"></div><div id="id_2_3" class="cell"></div><div id="id_3_3" class="cell"></div><div id="id_4_3" class="cell"></div>
		</div>
		<div class="row">
			<div id="id_0_4" class="cell"></div><div id="id_1_4" class="cell"></div><div id="id_2_4" class="cell"></div><div id="id_3_4" class="cell"></div><div id="id_4_4" class="cell"></div>
		</div>
	</div>
	<div class="interface">
		<div class="turn"></div>
		<div class="hunger"></div> 
		<div class="button_area">
			 <div class="no_button"></div><button type="button" class="up" onclick="up()">Cima</button><div class="no_button"></div>
			 <br>
		</div>
		<div class="button_area">
			 <button type="button" class="left" onclick="left()">Esquerda</button><button type="button" class="down" onclick="down()">Baixo</button><button type="button" class="right"  onclick="right()">Direita</button> 
		</div>
	</div>
</body>

<script>
	var $cow_x = 0;
	var $cow_y = 0;
	var $turn = -3;
	var $water_step = 0;
	var $max_hunger = 12;
	var $hunger = $max_hunger + 4;
	$(document).ready(function(){

		function randomNumberFromRange(min,max)
		{
			return Math.floor(Math.random()*(max-min+1)+min);
		}

		//codigo para rodar no começo
		var $y = [0,1,2,3,4];
		var $x = [0,1,2,3,4]; 
		var $rand;
		$($x).each(function(){
            var $x_val = this;
        	$($y).each(function(){
            	var $y_val = this;
        		var $elemento = "#id_"+$x_val+"_"+$y_val;
        		$rand = randomNumberFromRange(0, 4);
        		if ($rand == 0  ){
        			$($elemento).addClass("grass");
        		} else if($rand == 1 || $rand == 2) {
        			$($elemento).addClass("water");
        		} else {
        			$($elemento).addClass("ground");
        		}
        	});
        	
        	
        });
        $cow_x = randomNumberFromRange(0, 4);
       	$cow_y = randomNumberFromRange(0, 4);
        draw_cow();
		//$(".cow").remove();


		
		
   // jQuery methods go here...

	});

	function end_turn(){
		if (check_alive()==true){
			$turn +=1;
			$(".turn").html("Turno "+$turn);
			if (check_alive() == false){
				$hunger = 0;
			}
			check_hunger();
		}
		//check_alive();
	}

	function check_hunger(){
		//var className = $(cell_id).attr('class').split(' ')[1];
		if (get_cell_type() == "grass"){
			if ($hunger < $max_hunger){
				$hunger +=3;
				if ($hunger > $max_hunger){
					$hunger = $max_hunger;
				}
				
			}
			if ($hunger == $max_hunger){
				$(".hunger").html("Carai! Mucei!");	
			} else {
				$(".hunger").html("Nham! Nham!");
			}
			
		} else {//if (className == "water" ){
			$hunger -=1;
		}
		if ($hunger <= $max_hunger/2 && get_cell_type() != "grass" && $hunger > $max_hunger/3) {
			$(".hunger").html("...");
		} else if ($hunger <= $max_hunger/3) {
			$(".hunger").html("Fome do carai...");
		} else if($hunger > $max_hunger/3 && get_cell_type() != "grass"){
			$(".hunger").html("Tô de boa!");
		}
		if ($hunger == 0){
			check_alive();
			$(".hunger").html("MATOU A VAQUINHA, MONSTR@!!!")
		}
	}

	function get_position(){
		return "#id_"+$cow_x+"_"+$cow_y;
	}

	function get_cell_type(){
		return $(get_position()).attr('class').split(' ')[1];
	}

	function check_water(){
		if(get_cell_type() == "water"){
			$water_step +=1;
			if ($water_step == 3){
				$water_step = 0;
			}
		}
	}

	function check_alive(){
		if ($hunger < 1){
			$(".cow").remove();
			var $cow_pos = "#id_"+$cow_x+"_"+$cow_y;
			$($cow_pos).prepend('<img src="ghost.png" class="cow">');
			return false;
		} else {
			return true;
		}
	}

	function draw_cow(){
			$(".cow").remove();
			var $cow_pos = "#id_"+$cow_x+"_"+$cow_y;
			$($cow_pos).prepend('<img src="cow.png" class="cow">');
	};

	function up(){
		check_water();
		if ($cow_y > 0 && $water_step == 0 && check_alive() == true){
			$cow_y -= 1;
			draw_cow();
		}
		end_turn();
	};

	function down(){
		check_water();
		if ($cow_y < 4 && $water_step == 0 && check_alive() == true){
			$cow_y += 1;
			draw_cow();
		}
		end_turn();
	};

	function left(){
		check_water();
		if ($cow_x > 0 && $water_step == 0 && check_alive() == true){
			$cow_x -= 1;
			draw_cow();
		}
		end_turn();
	};

	function right(){
		check_water();
		if ($cow_x < 4 && $water_step == 0 && check_alive() == true){
			$cow_x += 1;
			draw_cow();
		}
		end_turn();
	};


	//eventos
		$(".up").click(up());
		$(".down").click(down());
		$(".left").click(left());
		$(".right").click(right());
	//var randomNumber = randomNumberFromRange(0, 1);
	





</script>
</html>